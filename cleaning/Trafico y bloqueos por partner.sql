SELECT
eventdate,
partnerid AS agg,
hotelid AS oid,
count(uow) AS rq
FROM data.lake.api_b2b_hsm_hotel_events_summarized_by_day
WHERE 1=1
AND eventdate is not null 
and partnerid in ('AP11615', 'AP11682', 'AP11683')
and eventdate >= date('2025-05-12')
GROUP BY 1,2,3
limit 100



-- agencia x
SELECT *
FROM data.lake.api_b2b_hsm_hotel_events_summarized_by_day
WHERE 1=1
AND eventdate is not null 
--and partnerid in ('AP12904')
and eventdate >= date('2025-06-20')
--limit 100

------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------

-- Nuitee EXP

--- Query de trafico de agencia + hotelid
--- uow = request_id, los = noches cotizadas, dba = days before arival, distribution = ?, eventdate = fecha_reserva, querydate = fecha de recopilacion de la data
SELECT *
FROM data.lake.api_b2b_hsm_hotel_events_summarized_by_day
WHERE 1=1
AND eventdate is not null 
and partnerid in ('AP12908')    ----- Agencia
--and eventdate >= date('2025-05-12') ----- Fecha de reserva
and eventdate >= date('2025-01-01')
and eventdate < date('2025-02-01')


-- Nuitee EXP
SELECT *
FROM data.lake.api_b2b_hsm_hotel_events_summarized_by_day
WHERE 1=1
AND eventdate is not null 
and partnerid in ('AP12908')--, 'AG00005220', 'AP11775', 'AP11777', 'AP12230', 'AP12907', 'AP12910')
--and eventdate >= date('2025-05-12')
and eventdate >= date('2025-01-01')
and eventdate < date('2025-02-01');




WITH tmp_hotel_ids AS (
  SELECT CAST(x AS BIGINT) AS hotelid
  FROM UNNEST(SPLIT(
    '1035521,1206812,1258772,1279981,1286507,1511087,1521971,1635995,1641274,1881474,1881743,1884019,1884321,1885762,1885876,1890146,1890146,200006,200314,200776,201550,2017277,2025437,2025437,2025632,2026475,202878,203901,203905,203936,204173,204606,204606,2046801,204719,204719,205101,2053900,2054760,2055590,205605,205678,205691,206019,206019,206175,2066035,2066936,2066936,2068104,2070106,2070106,207281,2075793,208079,2084224,208594,208940,209910,2101349,210244,210380,2104637,210837,211023,211493,211493,211677,2117313,212177,212605,214393,214421,214500,214689,214835,214852,214976,215431,215658,216018,216505,216747,216843,217770,218291,218396,218677,218721,219733,220431,2208617,221650,222616,2228177,2228177,222858,223230,224393,224717,226500,226847,226847,227900,227900,228022,228022,229300,229383,231084,231107,231219,231219,233077,233577,233611,233978,234205,234338,234754,234954,235064,235087,2353762,2354147,235479,2355219,2355429,2355429,2355824,2356018,2356994,2357057,235983,2359848,2359848,2360132,2360132,236048,236048,236062,2360729,236094,236101,236112,2361392,236170,236205,236205,2362058,2362058,2362739,236363,236363,236588,236606,2370248,2370314,2370314,2370315,2370315,2370443,2370540,2370594,2371622,2371622,2371926,2372217,2372679,2372699,2372801,2372801,237302,2373409,237376,2374289,2375287,2375287,2375524,2375524,2376997,2376997,2377031,2377859,238753,238753,239430,239779,239905,240286,240412,240412,240626,240746,240763,240780,241135,241329,241393,241471,241471,241495,241902,242086,242116,242116,242256,242256,242737,242800,242944,243084,243183,243183,243476,243488,243766,243778,243778,244054,244248,244313,244335,244335,244492,244522,244866,244866,245137,245137,2454624,245632,2460197,2460696,246355,246355,246456,246456,246472,2466491,2470594,2470594,2470658,2470673,2471604,2473593,2479664,2479719,2485479,2488156,2491886,2492547,2493834,2493836,2493912,2494233,2496920,249711,249711,2497472,249792,249792,249918,2499216,2499358,2499579,2499914,250022,250022,2503499,2507323,2508006,250813,2508168,2509292,2510316,251141,251141,2511838,251257,251337,251337,251589,251589,2520124,252343,252599,252599,252743,253085,253085,253743,255664,256480,256550,256665,257374,257931,258652,258745,258874,258928,259126,259265,259394,259394,259487,259505,259619,259619,259638,259707,260300,260398,260398,260487,260561,260589,260589,260886,261661,262138,262705,263524,264215,264215,264879,265332,265332,266388,267344,269342,269412,269489,269489,269822,270257,270257,270321,270433,270923,271123,271596,271968,272090,272240,272576,273544,274473,274859,274859,274887,275060,275060,276397,276947,276947,277714,277745,277865,277959,278029,278132,279231,279231,279246,279246,279363,279376,279376,279378,279385,279392,279584,279584,279785,280051,280702,280997,280997,282111,282251,282461,282897,282911,282934,283760,283760,284077,284568,284578,284578,284638,284895,285467,285563,285611,285717,286459,286459,287623,287907,288126,288163,288163,288237,288918,289303,289599,290618,290618,290842,290852,290934,290934,291102,291117,291250,291258,291258,291374,291417,291417,291503,291537,291586,291725,291787,291910,292082,292230,292230,292389,292484,292710,292866,293261,293348,293379,293482,293482,293889,293996,294152,294207,295697,295697,296044,296044,296347,296608,297135,297291,297329,297702,297702,297714,297859,297871,298162,298623,298715,299332,299332,299645,299775,300284,300284,300315,300315,300756,301246,301339,301540,301865,301865,302220,302369,302369,302489,303155,303155,303278,303325,303552,3035734,3035734,305846,305911,306326,306326,306762,307038,307856,308081,308081,308173,308431,308762,309054,309112,309112,309509,309509,309860,310460,310543,311160,311547,311648,311648,311702,311759,311817,311984,312198,312343,312390,312391,312634,312634,313119,313260,3146599,3147255,3147720,314876,3149116,3149116,3149755,315147,315333,3153838,3156899,3157453,3157810,3160050,316074,316418,3168926,3169587,3169587,318865,318865,3189565,3191556,319239,320046,320050,320143,320143,320284,320586,320586,320777,320816,320860,321175,321355,321355,321794,321828,321946,321946,322008,322262,322262,322267,323049,323216,323456,323982,324129,324348,324753,324756,324822,325013,325205,325332,325741,325941,325941,326903,327004,327055,327159,327406,327406,327892,328260,329076,329330,331579,338470,338559,338559,339348,339704,339800,340042,340141,340220,340220,340380,340560,340560,340793,341027,341096,341235,342215,342687,342811,343008,343678,343678,344411,345787,346233,347894,349714,350371,351507,352910,352994,352994,353274,353284,353553,353562,355656,3556755,3556755,355790,355791,356151,356440,357837,361218,363697,364236,364728,364728,365723,365938,365938,366376,366774,368272,369234,370796,370796,370869,371556,371556,374050,374538,374538,374611,374611,376187,376187,376603,377018,3773565,377564,379838,379838,381352,382302,382302,383264,383288,383288,383493,383535,383661,384568,384629,384707,384707,386115,3861235,387470,387784,388079,389701,390916,391387,392161,392707,394685,401010,402361,402750,402789,403916,406188,406319,407519,409107,410373,410599,412337,412337,417173,4176527,417677,417677,418075,419072,419230,419877,420381,4204593,421220,421422,421422,421706,421706,422231,422231,423674,423674,423769,4239343,424062,424295,4254522,4254522,425469,425824,425824,426285,4264024,426496,426496,4265122,4265122,4266207,426636,4274398,4277052,428977,4292213,4292673,4295815,4295815,429763,429830,431509,432351,433053,433610,433610,434359,435436,436001,436001,436751,437003,437155,437155,437439,437498,437837,438090,438105,438213,438213,438994,439081,439081,439384,440241,441793,442041,442234,442849,443699,443699,443968,444146,444731,445560,445954,446945,447332,447457,4479866,448325,448551,448551,4485672,448991,449197,449693,4498636,450407,450537,450761,450761,4513755,451852,4522742,452896,4531389,453528,453564,454965,454965,455831,455966,456112,456348,456463,456497,457005,457093,4576780,458070,459823,460615,460676,461604,464737,465228,465481,467858,4682828,468770,468898,4697605,4720852,4736130,475647,476537,477349,479012,479012,481874,482101,482101,483174,483174,485754,489596,490139,490384,494203,494304,494483,494483,4965238,4965943,497407,497499,498343,499352,500351,502062,502062,506105,506124,507400,508646,509349,510248,511829,511829,5121686,5152548,516051,518674,519091,519903,5219209,522659,527297,534710,537033,544001,548147,552493,552554,553072,553171,554403,561245,561245,561850,562489,562868,5680226,572750,587624,595095,602299,602299,605653,6056792,608569,610768,618026,624605,6263690,6263690,628619,631069,642365,6472927,6546614,664020,705338,705338,710890,711650,711650,729107,729107,733344,744703,762045,795920,803012,847713,856645,860492,860492,861435,861435,879782,884593,894008,894008,915867,920200,920200,921255,929842,936220,937840,947072,954687,965316,965316', ','
  )) AS x(x)  -- 
)
SELECT
--querydate,
--channel,
partnerid,
r.hotelid,
--uow,
checkin,
checkout,
dba,
los,
hasblock,
hasavailability,
eventdate,
  CASE 
    WHEN eventdate < DATE('2025-04-15') THEN 'Before mid-April'
    ELSE 'After mid-April'
  END AS period_label
FROM data.lake.api_b2b_hsm_hotel_events_summarized_by_day r
JOIN tmp_hotel_ids t ON r.hotelid = t.hotelid
WHERE 1=1
  AND eventdate IS NOT NULL 
  AND partnerid IN ('AP12908') --, 'AG00005220', 'AP11775', 'AP11777', 'AP12230', 'AP12907', 'AP12910')
  --AND eventdate >= DATE('2025-05-12')
  AND eventdate >= DATE('2025-01-01')
  AND eventdate <= DATE('2025-05-18')
  --order by eventdate desc

  
  
  
--- Version con conteo de total_rows, hasblock, y hasavailability
  
  WITH tmp_hotel_ids AS (
  SELECT CAST(x AS BIGINT) AS hotelid
  FROM UNNEST(SPLIT(
    '1035521,1206812,1258772,1279981,1286507', ','   ---- pocos hoteles de ejemplo
  )) AS x(x)
),
filtered_data AS (
  SELECT
    r.partnerid,
    r.hotelid,
    r.hasblock,
    r.hasavailability,
    CASE 
      WHEN r.eventdate < DATE('2025-04-15') THEN 'Before mid-April'
      ELSE 'After mid-April'
    END AS period_label
  FROM data.lake.api_b2b_hsm_hotel_events_summarized_by_day r
  JOIN tmp_hotel_ids t ON r.hotelid = t.hotelid
  WHERE 1=1
    AND r.eventdate IS NOT NULL 
    AND r.partnerid IN ('AP12908') ------ Nuitee EXP
    AND r.eventdate >= DATE('2025-04-14')
    AND r.eventdate <= DATE('2025-04-15')    -------- entre mas grande el periodo, mas tarda en evaluar
)
SELECT
  partnerid,
  hotelid,
  period_label,
  COUNT(*) AS total_rows,
  SUM(CASE WHEN hasblock THEN 1 ELSE 0 END) AS total_hasblock,
  SUM(CASE WHEN hasavailability THEN 1 ELSE 0 END) AS total_hasavailability
FROM filtered_data
GROUP BY partnerid, hotelid, period_label
--ORDER BY hotelid, period_label;



--- lo de arriba pero con todos los hoteles de Nuitee

  WITH tmp_hotel_ids AS (
  SELECT CAST(x AS BIGINT) AS hotelid
  FROM UNNEST(SPLIT(
    '', ','
  )) AS x(x)
),
filtered_data AS (
  SELECT
    r.partnerid,
    r.hotelid,
    r.hasblock,
    r.hasavailability,
    CASE 
      WHEN r.eventdate < DATE('2025-04-15') THEN 'Before mid-April'
      ELSE 'After mid-April'
    END AS period_label
  FROM data.lake.api_b2b_hsm_hotel_events_summarized_by_day r
  JOIN tmp_hotel_ids t ON r.hotelid = t.hotelid
  WHERE 1=1
    AND r.eventdate IS NOT NULL 
    AND r.partnerid IN ('AP12908') ------ Nuitee EXP
    AND r.eventdate >= DATE('2025-01-01')
    AND r.eventdate <= DATE('2025-05-18')    -------- entre mas grande el periodo, mas tarda en evaluar
)
SELECT
  partnerid,
  hotelid,
  period_label,
  COUNT(*) AS total_rows,
  SUM(CASE WHEN hasblock THEN 1 ELSE 0 END) AS total_hasblock,
  SUM(CASE WHEN hasavailability THEN 1 ELSE 0 END) AS total_hasavailability
FROM filtered_data
GROUP BY partnerid, hotelid, period_label
--ORDER BY hotelid, period_label;








  WITH tmp_hotel_ids AS (
  SELECT CAST(x AS BIGINT) AS hotelid
  FROM UNNEST(SPLIT(
    '203905,203936,204606,205691,211023,211493,211677,214689,214852,234205,234338,236101,236112,242256,246355,253085,260487,269489,270433,271123,274887,279385,279785,290842,293889,294207,296608,298162,309112,309860,310460,323049,331579,355656,356151,361218,368272,409107,410599,417677,420381,425469,435436,437003,438213,440241,450761,453564,455966,457093,459823,482101,483174,494203,879782,920200,921255,929842,1258772,1521971,1641274,2017277,2026475,2046801,2053900,2054760,2066035,2066936,2070106,2101349,2354147,2356018,2357057,2360132,2361392,2370540,2375524,2493834,2508006,2510316,3773565,4479866,4513755,4522742,4682828,4736130,6546614', ','
  )) AS x(x)
),
filtered_data AS (
  SELECT
    r.partnerid,
    r.hotelid,
    r.hasblock,
    r.hasavailability,
    CASE 
      WHEN r.eventdate < DATE('2025-04-15') THEN 'Before mid-April'
      ELSE 'After mid-April'
    END AS period_label
  FROM data.lake.api_b2b_hsm_hotel_events_summarized_by_day r
  JOIN tmp_hotel_ids t ON r.hotelid = t.hotelid
  WHERE 1=1
    AND r.eventdate IS NOT NULL 
    AND r.partnerid IN ('AP12908') ------ Nuitee EXP
    AND r.eventdate >= DATE('2025-01-01')
    AND r.eventdate <= DATE('2025-05-18')    -------- entre mas grande el periodo, mas tarda en evaluar
)
SELECT
  partnerid,
  hotelid,
  period_label,
  COUNT(*) AS total_rows,
  SUM(CASE WHEN hasblock THEN 1 ELSE 0 END) AS total_hasblock,
  SUM(CASE WHEN hasavailability THEN 1 ELSE 0 END) AS total_hasavailability
FROM filtered_data
GROUP BY partnerid, hotelid, period_label
--ORDER BY hotelid, period_label;






























WITH tmp_hotel_ids AS (
  SELECT CAST(x AS BIGINT) AS hotelid
  FROM UNNEST(SPLIT('1035521,1206812,1258772,1279981,1286507', ',')) AS x(x)
)
SELECT
  CASE
    WHEN r.eventdate < DATE '2025-04-15' THEN 'Before mid-April'
    ELSE 'After mid-April'
  END                                                   AS period_label,
  SUM(CASE WHEN r.hasblock        THEN 1 ELSE 0 END)    AS total_hasblock,
  SUM(CASE WHEN r.hasavailability THEN 1 ELSE 0 END)    AS total_hasavailability
FROM data.lake.api_b2b_hsm_hotel_events_summarized_by_day r
JOIN tmp_hotel_ids t ON r.hotelid = t.hotelid
WHERE r.partnerid = 'AP12908'
  AND r.eventdate BETWEEN DATE '2025-01-01' AND DATE '2025-05-18'
GROUP BY 1            -- 1 = primera expresión del SELECT
--ORDER BY 1;           -- opcional


SELECT 1;

EXPLAIN (TYPE IO)
SELECT
    CASE WHEN eventdate < DATE '2025-04-15' THEN 'Before' ELSE 'After' END,
    SUM(CASE WHEN hasblock        THEN 1 ELSE 0 END),
    SUM(CASE WHEN hasavailability THEN 1 ELSE 0 END)
FROM data.lake.api_b2b_hsm_hotel_events_summarized_by_day
WHERE partnerid = 'AP12908'
  AND hotelid IN (1035521,1206812,1258772,1279981,1286507)
  AND eventdate BETWEEN DATE '2025-01-01' AND DATE '2025-05-18'
GROUP BY 1;



CREATE TABLE scratch.ap12908_hotels_2025_q1_q2
WITH (
    format = 'PARQUET',
    partitioned_by = ARRAY['eventdate']   -- clave para que el filtro sí pruna
) AS
SELECT *
FROM data.lake.api_b2b_hsm_hotel_events_summarized_by_day
WHERE partnerid = 'AP12908'
  AND hotelid IN (1035521,1206812,1258772,1279981,1286507)
  AND eventdate >= TIMESTAMP '2025-01-01 00:00:00'
  AND eventdate <  TIMESTAMP '2025-05-19 00:00:00';






CREATE TABLE scratch.hsm_ap12908_2025_01_05
WITH (format = 'PARQUET', partitioned_by = ARRAY['eventdate'])
AS
SELECT *
FROM data.lake.api_b2b_hsm_hotel_events_summarized_by_day
WHERE partnerid = 'AP12908'
  AND hotelid IN (1035521,1206812,1258772,1279981,1286507)
  AND eventdate BETWEEN DATE '2025-01-01' AND DATE '2025-05-18';



 SELECT
    SUM(CASE WHEN hasblock        THEN 1 END) AS total_hasblock,
    SUM(CASE WHEN hasavailability THEN 1 END) AS total_hasavailability
FROM data.lake.api_b2b_hsm_hotel_events_summarized_by_day
WHERE partnerid = 'AP12908'
  AND hotelid IN (1035521)
  AND eventdate = DATE '2025-05-01';   -- un único día

  
  
  
  
  
  
  
  -- Before mid-Apr
SELECT 'Before mid-Apr' AS period_label,
       SUM(CASE WHEN hasblock THEN 1 END)        AS total_hasblock,
       SUM(CASE WHEN hasavailability THEN 1 END) AS total_hasavailability
FROM data.lake.api_b2b_hsm_hotel_events_summarized_by_day
WHERE 1=1
AND eventdate is not null 
and partnerid = 'AP12908'
  AND hotelid IN (1035521,1206812,1258772,1279981,1286507,1511087,1521971,1635995,1641274,1881474,1881743,1884019,1884321,1885762,1885876,1890146,1890146,200006,200314,200776,201550,2017277,2025437,2025437,2025632,2026475,202878,203901,203905,203936,204173,204606,204606,2046801,204719,204719,205101,2053900,2054760,2055590,205605,205678,205691,206019,206019,206175,2066035,2066936,2066936,2068104,2070106,2070106,207281,2075793,208079,2084224,208594,208940,209910,2101349,210244,210380,2104637,210837,211023,211493,211493,211677,2117313,212177,212605,214393,214421,214500,214689,214835,214852,214976,215431,215658,216018,216505,216747,216843,217770,218291,218396,218677,218721,219733,220431,2208617,221650,222616,2228177,2228177,222858,223230,224393,224717,226500,226847,226847,227900,227900,228022,228022,229300,229383,231084,231107,231219,231219,233077,233577,233611,233978,234205,234338,234754,234954,235064,235087,2353762,2354147,235479,2355219,2355429,2355429,2355824,2356018,2356994,2357057,235983,2359848,2359848,2360132,2360132,236048,236048,236062,2360729,236094,236101,236112,2361392,236170,236205,236205,2362058,2362058,2362739,236363,236363,236588,236606,2370248,2370314,2370314,2370315,2370315,2370443,2370540,2370594,2371622,2371622,2371926,2372217,2372679,2372699,2372801,2372801,237302,2373409,237376,2374289,2375287,2375287,2375524,2375524,2376997,2376997,2377031,2377859,238753,238753,239430,239779,239905,240286,240412,240412,240626,240746,240763,240780,241135,241329,241393,241471,241471,241495,241902,242086,242116,242116,242256,242256,242737,242800,242944,243084,243183,243183,243476,243488,243766,243778,243778,244054,244248,244313,244335,244335,244492,244522,244866,244866,245137,245137,2454624,245632,2460197,2460696,246355,246355,246456,246456,246472,2466491,2470594,2470594,2470658,2470673,2471604,2473593,2479664,2479719,2485479,2488156,2491886,2492547,2493834,2493836,2493912,2494233,2496920,249711,249711,2497472,249792,249792,249918,2499216,2499358,2499579,2499914,250022,250022,2503499,2507323,2508006,250813,2508168,2509292,2510316,251141,251141,2511838,251257,251337,251337,251589,251589,2520124,252343,252599,252599,252743,253085,253085,253743,255664,256480,256550,256665,257374,257931,258652,258745,258874,258928,259126,259265,259394,259394,259487,259505,259619,259619,259638,259707,260300,260398,260398,260487,260561,260589,260589,260886,261661,262138,262705,263524,264215,264215,264879,265332,265332,266388,267344,269342,269412,269489,269489,269822,270257,270257,270321,270433,270923,271123,271596,271968,272090,272240,272576,273544,274473,274859,274859,274887,275060,275060,276397,276947,276947,277714,277745,277865,277959,278029,278132,279231,279231,279246,279246,279363,279376,279376,279378,279385,279392,279584,279584,279785,280051,280702,280997,280997,282111,282251,282461,282897,282911,282934,283760,283760,284077,284568,284578,284578,284638,284895,285467,285563,285611,285717,286459,286459,287623,287907,288126,288163,288163,288237,288918,289303,289599,290618,290618,290842,290852,290934,290934,291102,291117,291250,291258,291258,291374,291417,291417,291503,291537,291586,291725,291787,291910,292082,292230,292230,292389,292484,292710,292866,293261,293348,293379,293482,293482,293889,293996,294152,294207,295697,295697,296044,296044,296347,296608,297135,297291,297329,297702,297702,297714,297859,297871,298162,298623,298715,299332,299332,299645,299775,300284,300284,300315,300315,300756,301246,301339,301540,301865,301865,302220,302369,302369,302489,303155,303155,303278,303325,303552,3035734,3035734,305846,305911,306326,306326,306762,307038,307856,308081,308081,308173,308431,308762,309054,309112,309112,309509,309509,309860,310460,310543,311160,311547,311648,311648,311702,311759,311817,311984,312198,312343,312390,312391,312634,312634,313119,313260,3146599,3147255,3147720,314876,3149116,3149116,3149755,315147,315333,3153838,3156899,3157453,3157810,3160050,316074,316418,3168926,3169587,3169587,318865,318865,3189565,3191556,319239,320046,320050,320143,320143,320284,320586,320586,320777,320816,320860,321175,321355,321355,321794,321828,321946,321946,322008,322262,322262,322267,323049,323216,323456,323982,324129,324348,324753,324756,324822,325013,325205,325332,325741,325941,325941,326903,327004,327055,327159,327406,327406,327892,328260,329076,329330,331579,338470,338559,338559,339348,339704,339800,340042,340141,340220,340220,340380,340560,340560,340793,341027,341096,341235,342215,342687,342811,343008,343678,343678,344411,345787,346233,347894,349714,350371,351507,352910,352994,352994,353274,353284,353553,353562,355656,3556755,3556755,355790,355791,356151,356440,357837,361218,363697,364236,364728,364728,365723,365938,365938,366376,366774,368272,369234,370796,370796,370869,371556,371556,374050,374538,374538,374611,374611,376187,376187,376603,377018,3773565,377564,379838,379838,381352,382302,382302,383264,383288,383288,383493,383535,383661,384568,384629,384707,384707,386115,3861235,387470,387784,388079,389701,390916,391387,392161,392707,394685,401010,402361,402750,402789,403916,406188,406319,407519,409107,410373,410599,412337,412337,417173,4176527,417677,417677,418075,419072,419230,419877,420381,4204593,421220,421422,421422,421706,421706,422231,422231,423674,423674,423769,4239343,424062,424295,4254522,4254522,425469,425824,425824,426285,4264024,426496,426496,4265122,4265122,4266207,426636,4274398,4277052,428977,4292213,4292673,4295815,4295815,429763,429830,431509,432351,433053,433610,433610,434359,435436,436001,436001,436751,437003,437155,437155,437439,437498,437837,438090,438105,438213,438213,438994,439081,439081,439384,440241,441793,442041,442234,442849,443699,443699,443968,444146,444731,445560,445954,446945,447332,447457,4479866,448325,448551,448551,4485672,448991,449197,449693,4498636,450407,450537,450761,450761,4513755,451852,4522742,452896,4531389,453528,453564,454965,454965,455831,455966,456112,456348,456463,456497,457005,457093,4576780,458070,459823,460615,460676,461604,464737,465228,465481,467858,4682828,468770,468898,4697605,4720852,4736130,475647,476537,477349,479012,479012,481874,482101,482101,483174,483174,485754,489596,490139,490384,494203,494304,494483,494483,4965238,4965943,497407,497499,498343,499352,500351,502062,502062,506105,506124,507400,508646,509349,510248,511829,511829,5121686,5152548,516051,518674,519091,519903,5219209,522659,527297,534710,537033,544001,548147,552493,552554,553072,553171,554403,561245,561245,561850,562489,562868,5680226,572750,587624,595095,602299,602299,605653,6056792,608569,610768,618026,624605,6263690,6263690,628619,631069,642365,6472927,6546614,664020,705338,705338,710890,711650,711650,729107,729107,733344,744703,762045,795920,803012,847713,856645,860492,860492,861435,861435,879782,884593,894008,894008,915867,920200,920200,921255,929842,936220,937840,947072,954687,965316,965316)
  AND eventdate BETWEEN DATE '2025-01-01' AND DATE '2025-04-14';

 
-- After mid-Apr
SELECT 'After mid-Apr',
       ...
  AND eventdate BETWEEN DATE '2025-04-15' AND DATE '2025-05-18';

 




